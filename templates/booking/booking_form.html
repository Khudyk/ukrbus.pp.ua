{% extends 'base.html' %}
{% block content %}

<div class="container mt-4">
    <div class="row justify-content-center mb-5">
        <div class="col-lg-10">
            <div class="glass-card mt-n5 shadow-lg p-4" style="overflow: visible !important;">
                <form action="{% url 'booking_route_list' %}" method="GET" class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label small text-white-50">Звідки</label>
                        <div class="input-group">
                            <span class="input-group-text bg-transparent border-0 text-warning"><i class="fas fa-map-marker-alt"></i></span>
                            <input type="text" name="start_city" class="form-control glass-input" placeholder="Місто відправлення" list="cities-list" value="{{ request.GET.start_city|default:'' }}">
                        </div>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label small text-white-50">Куди</label>
                        <div class="input-group">
                            <span class="input-group-text bg-transparent border-0 text-warning"><i class="fas fa-route"></i></span>
                            <input type="text" name="end_city" class="form-control glass-input" placeholder="Місто прибуття" list="cities-list" value="{{ request.GET.end_city|default:'' }}">
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label class="form-label small text-white-50">Дата</label>
                        <div class="input-group">
                            <span class="input-group-text bg-transparent border-0 text-warning"><i class="fas fa-calendar-alt"></i></span>
                            <input type="date" name="date" class="form-control glass-input" value="{{ request.GET.date|default:'' }}">
                        </div>
                    </div>

                    <div class="col-md-1 d-flex align-items-end">
                        <button type="submit" class="btn glass-btn-registration w-100">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <datalist id="cities-list">
        {% for city in available_cities %}
            <option value="{{ city }}">
        {% endfor %}
    </datalist>

    <div class="row">
        {% if not request.GET.start_city or not request.GET.end_city %}
            <div class="col-12 text-center py-5">
                <div class="glass-card d-inline-block p-5">
                    <i class="fas fa-bus-alt fa-3x text-primary mb-3 opacity-50"></i>
                    <h3 class="text-white">Почніть пошук</h3>
                    <p class="text-white-50">Вкажіть міста відправлення та прибуття, щоб побачити доступні маршрути.</p>
                </div>
            </div>
        {% else %}
            {% for route in routes %}
                <div class="col-12 mb-4">
                    {% include 'booking/_route_card.html' %}
                </div>
            {% empty %}
                <div class="col-12 text-center py-5">
                    <div class="glass-card d-inline-block p-5" style="border: 1px dashed rgba(255,255,255,0.1);">
                        <i class="fas fa-search-location fa-3x text-warning mb-3"></i>
                        <h3 class="text-white">Маршрутів не знайдено</h3>
                        <p class="text-white-50">На жаль, ми не знайшли рейсів між містами <strong>{{ request.GET.start_city }}</strong> та <strong>{{ request.GET.end_city }}</strong>.</p>
                        <a href="{% url 'booking_route_list' %}" class="btn btn-outline-warning mt-3">Скинути пошук</a>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
    </div>
</div>

{% endblock %}